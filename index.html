<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Research Log</title>
    
    <!-- Tailwind CSS for clean, readable styling (Dyslexia-friendly spacing) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Marked.js for rendering Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Highlight.js for R code highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/r.min.js"></script>

    <style>
        /* Dyslexia-friendly typography adjustments */
        body { font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; letter-spacing: 0.025em; line-height: 1.75; }
        .markdown-content h1 { font-size: 2.25rem; font-weight: 700; margin-top: 2rem; margin-bottom: 1rem; color: #1f2937; }
        .markdown-content h2 { font-size: 1.5rem; font-weight: 600; margin-top: 1.5rem; margin-bottom: 0.75rem; color: #374151; }
        .markdown-content p { margin-bottom: 1.25rem; font-size: 1.125rem; color: #4b5563; }
        .markdown-content ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.25rem; color: #4b5563; }
        .markdown-content pre { background-color: #1f2937; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 1.25rem; }
        .markdown-content code { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace; font-size: 0.875rem; }
        .nav-active { background-color: #e5e7eb; font-weight: 600; color: #111827; }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 antialiased">

    <!-- 
    ========================================================================
    EDIT YOUR CONFIGURATION HERE
    This is the ONLY part of this file you need to change.
    ========================================================================
    -->
    <script>
        const SITE_CONFIG = {
            profile: {
                name: "The Inquisitive Researcher",
                subtitle: "Veterinarian & Network Biologist",
                photo: "https://images.unsplash.com/photo-1532094349884-543bc11b234d?auto=format&fit=crop&q=80&w=400&h=400" 
            },

            // Link to your separate .md files here
            navigation: [
                { 
                    label: "Learning Log", 
                    subpages: [
                        { id: "log_day1", label: "Day 1: The Divergence", file: "content/log_day1.md" },
                        { id: "log_day2", label: "Day 2: Wiring the Graph", file: "content/log_day2.md" }
                    ]
                },
                { id: "research", label: "NSS vs GXS Research", file: "content/research.md" },
                { id: "code", label: "R Code Snippets", file: "content/code.md" }
            ]
        };
    </script>
    <!-- ======================================================================== -->

    <div class="max-w-6xl mx-auto flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar Navigation -->
        <aside class="w-full md:w-64 bg-white border-r border-gray-200 flex-shrink-0">
            <div class="p-6 md:sticky md:top-0">
                <div class="text-center md:text-left mb-8">
                    <img id="profile-img" src="" alt="Profile" class="w-24 h-24 rounded-full mx-auto md:mx-0 object-cover mb-4 border-2 border-gray-200">
                    <h1 id="profile-name" class="text-xl font-bold text-gray-900"></h1>
                    <p id="profile-subtitle" class="text-sm text-gray-500 font-medium mt-1"></p>
                </div>
                <nav id="nav-menu" class="flex flex-row md:flex-col space-x-2 md:space-x-0 md:space-y-2 overflow-x-auto pb-4 md:pb-0">
                    <!-- Buttons are injected here automatically -->
                </nav>
            </div>
        </aside>

        <!-- Main Content Area -->
        <main class="flex-1 p-6 md:p-12 lg:p-16 bg-gray-50">
            <div class="max-w-3xl mx-auto bg-white p-8 md:p-12 shadow-sm rounded-xl border border-gray-100">
                <div id="content-area" class="markdown-content">
                    <!-- Markdown content will load here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Application Logic for loading files -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('profile-name').textContent = SITE_CONFIG.profile.name;
            document.getElementById('profile-subtitle').textContent = SITE_CONFIG.profile.subtitle;
            document.getElementById('profile-img').src = SITE_CONFIG.profile.photo;

            const navMenu = document.getElementById('nav-menu');
            const contentArea = document.getElementById('content-area');
            let defaultItem = SITE_CONFIG.navigation[0].subpages ? SITE_CONFIG.navigation[0].subpages[0] : SITE_CONFIG.navigation[0];

            async function renderPage(item) {
                // Highlight the active button
                document.querySelectorAll('.nav-btn').forEach(btn => {
                    if(btn.dataset.id === item.id) {
                        btn.classList.add('nav-active', 'bg-gray-100', 'text-gray-900');
                        btn.classList.remove('text-gray-600', 'hover:bg-gray-50');
                    } else {
                        btn.classList.remove('nav-active', 'bg-gray-100', 'text-gray-900');
                        btn.classList.add('text-gray-600', 'hover:bg-gray-50');
                    }
                });

                contentArea.innerHTML = "<p class='text-gray-500 animate-pulse'>Loading research notes...</p>";

                try {
                    // This fetches your external .md files
                    const response = await fetch(item.file);
                    if (!response.ok) throw new Error(`Could not load ${item.file}`);
                    
                    const rawMarkdown = await response.text();
                    contentArea.innerHTML = marked.parse(rawMarkdown);

                    // Applies R code highlighting
                    document.querySelectorAll('pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                } catch (error) {
                    contentArea.innerHTML = `
                        <div class="bg-red-50 border-l-4 border-red-500 p-4">
                            <h3 class="text-red-800 font-bold">Error Loading File</h3>
                            <p class="text-red-700 mt-2">Could not find <code>${item.file}</code>.</p>
                            <p class="text-red-700 mt-2 text-sm"><strong>Note:</strong> If you are testing this locally or in a preview window, the browser blocks dynamic file loading for security, or the file doesn't exist yet. It will work perfectly once pushed to GitHub Pages with your 'content' folder!</p>
                        </div>
                    `;
                }
            }

            function createNavButton(item) {
                const btn = document.createElement('button');
                btn.textContent = item.label;
                btn.dataset.id = item.id;
                btn.className = "nav-btn text-left px-4 py-2 rounded-lg text-sm md:text-base font-medium transition-colors whitespace-nowrap md:whitespace-normal w-full";
                
                btn.addEventListener('click', () => {
                    renderPage(item);
                    if(window.innerWidth < 768) {
                        window.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                });
                return btn;
            }

            SITE_CONFIG.navigation.forEach(navItem => {
                if (navItem.subpages) {
                    const details = document.createElement('details');
                    details.open = true;
                    details.className = "mb-3 group";

                    const summary = document.createElement('summary');
                    summary.textContent = navItem.label;
                    summary.className = "cursor-pointer list-none font-bold text-gray-400 uppercase tracking-wider text-xs px-2 mb-2 hover:text-gray-600 transition-colors";
                    details.appendChild(summary);

                    const subContainer = document.createElement('div');
                    subContainer.className = "flex flex-col space-y-1 border-l-2 border-gray-100 ml-3 pl-2";

                    navItem.subpages.forEach(subItem => {
                        const btn = createNavButton(subItem);
                        subContainer.appendChild(btn);
                    });

                    details.appendChild(subContainer);
                    navMenu.appendChild(details);
                } else {
                    const btn = createNavButton(navItem);
                    btn.classList.add('mb-2');
                    navMenu.appendChild(btn);
                }
            });

            // Load the first page on startup
            renderPage(defaultItem);
        });
    </script>
</body>
</html>